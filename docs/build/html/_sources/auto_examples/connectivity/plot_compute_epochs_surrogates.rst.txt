
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/connectivity/plot_compute_epochs_surrogates.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_connectivity_plot_compute_epochs_surrogates.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_connectivity_plot_compute_epochs_surrogates.py:


=============
Surrogate Connectivity Generation
=============

Example to show surrogate generation on Epochs using the jumeg Surrogates
module.

.. GENERATED FROM PYTHON SOURCE LINES 11-60



.. image-sg:: /auto_examples/connectivity/images/sphx_glr_plot_compute_epochs_surrogates_001.png
   :alt: Evoked (102 channels), Surrogate Evoked (102 channels)
   :srcset: /auto_examples/connectivity/images/sphx_glr_plot_compute_epochs_surrogates_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Opening raw data file /Users/praveen.sripad/nanna_data/mne_data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
        Read a total of 4 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
            Average EEG reference (1 x 60)  idle
        Range : 6450 ... 48149 =     42.956 ...   320.665 secs
    Ready.
    Not setting metadata
    72 matching events found
    Setting baseline interval to [-0.19979521315838786, 0.0] s
    Applying baseline correction (mode: mean)
    Created an SSP operator (subspace dimension = 3)
    4 projection items activated
    Loading data for 72 events and 106 original time points ...
        Rejecting  epoch based on MAG : ['MEG 1711']
    1 bad epochs dropped
    WARNING: Currently surrogates on Epochs only returns a generator.
    computing surrogate 0 
    NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
    Removing projector <Projection | Average EEG reference, active : True, n_channels : 60>
    NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
    Removing projector <Projection | Average EEG reference, active : True, n_channels : 60>






|

.. code-block:: default


    import os.path as op
    import numpy as np
    import matplotlib.pyplot as pl
    from mne.datasets import sample
    import mne

    from jumeg.jumeg_surrogates import Surrogates, check_power_spectrum

    data_path = sample.data_path()
    subjects_dir = op.join(data_path, 'subjects')

    fname_raw = op.join(data_path, 'MEG/sample/sample_audvis_filt-0-40_raw.fif')
    fname_event = op.join(data_path, 'MEG/sample/sample_audvis_filt-0-40_raw-eve.fif')

    epochs_testing = False

    raw = mne.io.read_raw_fif(fname_raw)
    events = mne.read_events(fname_event)

    # add a bad channel
    raw.info['bads'] += ['MEG 2443']

    # pick MEG channels
    picks = mne.pick_types(raw.info, meg='mag', eeg=False, stim=False, eog=False,
                           exclude='bads')

    # Define epochs for left-auditory condition
    event_id, tmin, tmax = 1, -0.2, 0.5
    epochs = mne.Epochs(raw, events, event_id, tmin, tmax, picks=picks,
                        baseline=(None, 0), reject=dict(mag=4e-12))

    # initialize the Surrogates object
    surr_epochs = Surrogates(epochs)

    n_surr = 10  # number of surrogates
    mode = 'randomize_phase'
    mysurr = surr_epochs.compute_surrogates(n_surr=n_surr,
                                            mode=mode, return_generator=False)

    # get one epochs for plotting
    # for epochs, a generator is always returned
    first_surr_epoch = next(mysurr)

    # visualize surrogates
    fig, (ax1, ax2) = pl.subplots(2, 1)
    epochs.average().plot(axes=ax1, show=False, titles='Evoked')
    first_surr_epoch.average().plot(axes=ax2, show=False, titles='Surrogate Evoked')
    pl.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.538 seconds)


.. _sphx_glr_download_auto_examples_connectivity_plot_compute_epochs_surrogates.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_compute_epochs_surrogates.py <plot_compute_epochs_surrogates.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_compute_epochs_surrogates.ipynb <plot_compute_epochs_surrogates.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
